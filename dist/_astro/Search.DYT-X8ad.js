import{o as oe,a as le,s as J,b as P,r as K}from"./lifecycle.93sJC7Cf.js";import{l as ce,n as h,o as de,v as V,f as ue,t as W,w as k,g as t,a as Y,p as fe,b as me,e as n,d as i,s as d,h as N,r as o,x as j}from"./utils.B7PHiYi3.js";import{s as pe}from"./render.C35p3UC7.js";import{e as he,i as ve}from"./each.w2JWTWyQ.js";import{I as x,h as be}from"./Icon.QkT1-JiB.js";import{b as q}from"./input.ChDPSwf5.js";import{I as A}from"./zh_TW.B395Vq90.js";import{i as G}from"./translation.-NShsQMM.js";import{n as ge}from"./navigation-utils.Cc6bKnia.js";import{u as H}from"./url-utils.BHy3cDl6.js";/* empty css                        */import"./if.BJgN68_l.js";import"./props.D5mhnFgQ.js";import"./config.B6KQt6aH.js";var we=N(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-sm text-50"><!></div></a>`),ke=N(`<div class="hidden lg:block relative w-11 h-11 shrink-0"><div id="search-bar" role="button" tabindex="0" aria-label="Search"><!> <input id="search-input-desktop"/></div></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed absolute md:w-[30rem] top-20 left-4 md:left-[unset] right-4 z-50 search-panel shadow-2xl rounded-2xl p-2"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function Me(O,Q){me(Q,!0);let l=h(""),v=h(""),c=h(de([])),y=!1,b=h(!1),s=h(!1),_,T=!1,I,B;const xe=[{url:H("/"),meta:{title:"This Is a Fake Search Result"},excerpt:"Because the search cannot work in the <mark>dev</mark> environment."},{url:H("/"),meta:{title:"If You Want to Test the Search"},excerpt:"Try running <mark>npm build && npm preview</mark> instead."}],U=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},$=()=>{T||(n(s,!t(s)),t(s)&&setTimeout(()=>{document.getElementById("search-input-desktop")?.focus()},0))},X=()=>{t(l)||n(s,!1)},Z=()=>{B=setTimeout(()=>{n(s,!1),m(!1,!0)},200)},m=(e,a)=>{const r=document.getElementById("search-panel");!r||!a||(e?r.classList.remove("float-panel-closed"):r.classList.add("float-panel-closed"))},ee=()=>{const e=document.getElementById("search-panel");e&&e.classList.add("float-panel-closed"),n(l,""),n(v,""),n(c,[],!0)},te=(e,a)=>{e.preventDefault(),ee(),ge(a)},D=async(e,a)=>{if(!e){m(!1,a),n(c,[],!0);return}if(t(b))try{let r=[];if(y&&window.pagefind){const p=await window.pagefind.search(e);r=await Promise.all(p.results.map(w=>w.data()))}else r=[],console.error("Pagefind is not available in production environment.");n(c,r,!0),m(t(c).length>0,a)}catch(r){console.error("Search error:",r),n(c,[],!0),m(!1,a)}};oe(()=>{const e=()=>{n(b,!0),y=typeof window<"u"&&!!window.pagefind&&typeof window.pagefind.search=="function",console.log("Pagefind status on init:",y)};document.addEventListener("pagefindready",()=>{console.log("Pagefind ready event received."),e()}),document.addEventListener("pagefindloaderror",()=>{console.warn("Pagefind load error event received. Search functionality will be limited."),e()}),setTimeout(()=>{t(b)||(console.log("Fallback: Initializing search after timeout."),e())},2e3);const a=()=>{T=!0,clearTimeout(I),I=setTimeout(()=>{T=!1},500)};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}}),V(()=>{if(t(b)){const e=t(l)||t(v),a=!!t(l)||t(s);clearTimeout(_),e?_=setTimeout(()=>{D(e,a)},300):(n(c,[],!0),m(!1,a))}}),V(()=>{if(typeof document<"u"){const e=document.getElementById("navbar");t(s)?e?.classList.add("is-searching"):e?.classList.remove("is-searching")}}),le(()=>{typeof document<"u"&&document.getElementById("navbar")?.classList.remove("is-searching"),clearTimeout(_),clearTimeout(I)});var z=ke(),E=ue(z),u=i(E);u.__click=()=>{document.getElementById("search-input-desktop")?.focus()};var F=i(u);{let e=j(()=>t(s)?"left-3":"left-1/2 -translate-x-1/2"),a=j(()=>t(s)?"text-black/30 dark:text-white/30":"");x(F,{icon:"material-symbols:search",get class(){return`absolute text-[1.25rem] pointer-events-none ${t(e)??""} transition top-1/2 -translate-y-1/2 ${t(a)??""}`}})}var f=d(F,2);K(f),o(u),o(E);var g=d(E,2);g.__click=U;var ae=i(g);x(ae,{icon:"material-symbols:search",class:"text-[1.25rem]"}),o(g);var R=d(g,2),L=i(R),M=i(L);x(M,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var S=d(M,2);K(S),o(L);var re=d(L,2);he(re,17,()=>t(c),ve,(e,a)=>{var r=we();r.__click=ie=>te(ie,t(a).url);var p=i(r),w=i(p,!0),se=d(w);x(se,{icon:"fa7-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),o(p);var C=d(p,2),ne=i(C);be(ne,()=>t(a).excerpt),o(C),o(r),W(()=>{P(r,"href",t(a).url),pe(w,t(a).meta.title)}),Y(e,r)}),o(R),W((e,a)=>{J(u,1,`flex transition-all items-center h-11 rounded-lg absolute right-0 top-0 shrink-0
            ${t(s)?"bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06] dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10":"btn-plain active:scale-90"}
            ${t(s)?"w-48":"w-11"}`),P(f,"placeholder",e),J(f,1,`transition-all pl-10 text-sm bg-transparent outline-0
                h-full ${t(s)?"w-36":"w-0"} text-black/50 dark:text-white/50`,"svelte-1wah7ro"),P(S,"placeholder",a)},[()=>G(A.search),()=>G(A.search)]),k("mouseenter",u,()=>{t(s)||$()}),k("mouseleave",u,X),k("focus",f,()=>{clearTimeout(B),t(s)||$(),D(t(l),!0)}),k("blur",f,Z),q(f,()=>t(l),e=>n(l,e)),q(S,()=>t(v),e=>n(v,e)),Y(O,z),fe()}ce(["click"]);export{Me as default};
